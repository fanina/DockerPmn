version: "3.8"

services: 
  db: 
    image: "mysql:8.0"
    volumes:
      - "dbapp:/var/lib/mysql"
    environment: 
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
    ports:
      - 127.0.0.1:3307:3306
    networks:
      - symfony_db_net

  nginx: 
    image : nginx:1.17.8-alpine
    build:
      context: .
      dockerfile: docker/nginx/Dockerfile
    volumes:
      - ./docker/nginx/:/gateway/etc/nginx/conf.d
    ports:
      - 80:80
    networks:
      - symfony_db_net

  php: 
    image : php:7.4-fpm-buster
    build : 
      context: .
      dockerfile: docker/php/Dockerfile
    volumes:
      - ./apps/my-symfony-app/:/usr/src/my-symfony-app/
    networks:
      - symfony_db_net
      
volumes:
    dbapp:
networks:
    symfony_db_net:


